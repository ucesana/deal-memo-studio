import{a as Nt,b as wt}from"./chunk-E3ALKDQG.js";import{c as Be}from"./chunk-EQSAGTQR.js";import{b as _e}from"./chunk-7ZFQWY3G.js";import{a as me,c as It}from"./chunk-J44G4YSX.js";import{a as Et,c as fe,d as Tt}from"./chunk-KB7U2Z4W.js";import{g as ct,j as pt}from"./chunk-QA4PX2VU.js";import{B as _t,E as vt,L as xt,M as Se,O as Ae,S as ge,U as bt,Z as yt,_ as Ct,j as ut,k as ht,o as gt,oa as Dt,t as ft,ta as Mt,x as he,y as mt}from"./chunk-666DXB2I.js";import{h as at,i as dt,j as lt}from"./chunk-WQZ5FTDX.js";import{$ as K,$b as tt,Ac as rt,C as je,D as Te,Dc as ue,G as Ie,Gb as A,Ha as Z,Hb as te,I as Ne,Ja as V,Jb as ie,Jc as ot,L as C,Lb as Ze,Mb as Je,Nb as et,O as Ge,Ob as b,Oc as ne,Pb as p,Pc as st,Qb as g,Rb as I,Rc as M,Sc as P,Ub as de,Vb as Q,Wb as le,Xb as _,Yb as f,Z as we,_ as W,a as oe,ac as B,b as se,ba as X,bc as N,c as He,cc as w,d as Me,eb as ke,fa as Ue,fb as u,ga as Y,gc as Fe,hb as ae,hc as ce,ia as qe,ic as it,jb as Xe,k as U,kc as D,l as y,la as a,lc as pe,mb as H,mc as $,n as Qe,p as h,qa as E,qb as x,r as $e,ra as T,rb as J,sb as m,t as v,u as q,ub as O,va as We,vc as R,wb as S,x as Ee,yb as ee,zb as Ye,zc as nt}from"./chunk-GHECAUUU.js";var Re=class{dataNodes;expansionModel=new Be(!0);trackBy;getLevel;isExpandable;getChildren;toggle(r){this.expansionModel.toggle(this._trackByValue(r))}expand(r){this.expansionModel.select(this._trackByValue(r))}collapse(r){this.expansionModel.deselect(this._trackByValue(r))}isExpanded(r){return this.expansionModel.isSelected(this._trackByValue(r))}toggleDescendants(r){this.expansionModel.isSelected(this._trackByValue(r))?this.collapseDescendants(r):this.expandDescendants(r)}collapseAll(){this.expansionModel.clear()}expandDescendants(r){let e=[r];e.push(...this.getDescendants(r)),this.expansionModel.select(...e.map(t=>this._trackByValue(t)))}collapseDescendants(r){let e=[r];e.push(...this.getDescendants(r)),this.expansionModel.deselect(...e.map(t=>this._trackByValue(t)))}_trackByValue(r){return this.trackBy?this.trackBy(r):r}},ve=class extends Re{getLevel;isExpandable;options;constructor(r,e,t){super(),this.getLevel=r,this.isExpandable=e,this.options=t,this.options&&(this.trackBy=this.options.trackBy)}getDescendants(r){let e=this.dataNodes.indexOf(r),t=[];for(let i=e+1;i<this.dataNodes.length&&this.getLevel(r)<this.getLevel(this.dataNodes[i]);i++)t.push(this.dataNodes[i]);return t}expandAll(){this.expansionModel.select(...this.dataNodes.map(r=>this._trackByValue(r)))}};var Pe=new qe("CDK_TREE_NODE_OUTLET_NODE"),xe=(()=>{class n{viewContainer=a(H);_node=a(Pe,{optional:!0});constructor(){}static \u0275fac=function(t){return new(t||n)};static \u0275dir=m({type:n,selectors:[["","cdkTreeNodeOutlet",""]]})}return n})(),Oe=class{$implicit;level;index;count;constructor(r){this.$implicit=r}},be=(()=>{class n{template=a(ae);when;constructor(){}static \u0275fac=function(t){return new(t||n)};static \u0275dir=m({type:n,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:[0,"cdkTreeNodeDefWhen","when"]}})}return n})();function kt(){return Error("Could not find a tree control, levelAccessor, or childrenAccessor for the tree.")}var G=(()=>{class n{_differs=a(st);_changeDetectorRef=a(ne);_elementRef=a(V);_dir=a(Se);_onDestroy=new U;_dataDiffer;_defaultNodeDef;_dataSubscription;_levels=new Map;_parents=new Map;_ariaSets=new Map;get dataSource(){return this._dataSource}set dataSource(e){this._dataSource!==e&&this._switchDataSource(e)}_dataSource;treeControl;levelAccessor;childrenAccessor;trackBy;expansionKey;_nodeOutlet;_nodeDefs;viewChange=new y({start:0,end:Number.MAX_VALUE});_expansionModel;_flattenedNodes=new y([]);_nodeType=new y(null);_nodes=new y(new Map);_keyManagerNodes=new y([]);_keyManagerFactory=a(mt);_keyManager;_viewInit=!1;constructor(){}ngAfterContentInit(){this._initializeKeyManager()}ngAfterContentChecked(){this._updateDefaultNodeDefinition(),this._subscribeToDataChanges()}ngOnDestroy(){this._nodeOutlet.viewContainer.clear(),this.viewChange.complete(),this._onDestroy.next(),this._onDestroy.complete(),this._dataSource&&typeof this._dataSource.disconnect=="function"&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null),this._keyManager?.destroy()}ngOnInit(){this._checkTreeControlUsage(),this._initializeDataDiffer()}ngAfterViewInit(){this._viewInit=!0}_updateDefaultNodeDefinition(){let e=this._nodeDefs.filter(t=>!t.when);e.length>1,this._defaultNodeDef=e[0]}_setNodeTypeIfUnset(e){this._nodeType.value===null&&this._nodeType.next(e)}_switchDataSource(e){this._dataSource&&typeof this._dataSource.disconnect=="function"&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null),e||this._nodeOutlet.viewContainer.clear(),this._dataSource=e,this._nodeDefs&&this._subscribeToDataChanges()}_getExpansionModel(){return this.treeControl?this.treeControl.expansionModel:(this._expansionModel??=new Be(!0),this._expansionModel)}_subscribeToDataChanges(){if(this._dataSubscription)return;let e;Ct(this._dataSource)?e=this._dataSource.connect(this):$e(this._dataSource)?e=this._dataSource:Array.isArray(this._dataSource)&&(e=h(this._dataSource)),e&&(this._dataSubscription=this._getRenderData(e).pipe(K(this._onDestroy)).subscribe(t=>{this._renderDataChanges(t)}))}_getRenderData(e){let t=this._getExpansionModel();return q([e,this._nodeType,t.changed.pipe(we(null),X(i=>{this._emitExpansionChanges(i)}))]).pipe(W(([i,o])=>o===null?h({renderNodes:i,flattenedNodes:null,nodeType:o}):this._computeRenderingData(i,o).pipe(v(s=>se(oe({},s),{nodeType:o})))))}_renderDataChanges(e){if(e.nodeType===null){this.renderNodeChanges(e.renderNodes);return}this._updateCachedData(e.flattenedNodes),this.renderNodeChanges(e.renderNodes),this._updateKeyManagerItems(e.flattenedNodes)}_emitExpansionChanges(e){if(!e)return;let t=this._nodes.value;for(let i of e.added)t.get(i)?._emitExpansionState(!0);for(let i of e.removed)t.get(i)?._emitExpansionState(!1)}_initializeKeyManager(){let e=q([this._keyManagerNodes,this._nodes]).pipe(v(([i,o])=>i.reduce((s,d)=>{let l=o.get(this._getExpansionKey(d));return l&&s.push(l),s},[]))),t={trackBy:i=>this._getExpansionKey(i.data),skipPredicate:i=>!!i.isDisabled,typeAheadDebounceInterval:!0,horizontalOrientation:this._dir.value};this._keyManager=this._keyManagerFactory(e,t)}_initializeDataDiffer(){let e=this.trackBy??((t,i)=>this._getExpansionKey(i));this._dataDiffer=this._differs.find([]).create(e)}_checkTreeControlUsage(){}renderNodeChanges(e,t=this._dataDiffer,i=this._nodeOutlet.viewContainer,o){let s=t.diff(e);!s&&!this._viewInit||(s?.forEachOperation((d,l,c)=>{if(d.previousIndex==null)this.insertNode(e[c],c,i,o);else if(c==null)i.remove(l);else{let F=i.get(l);i.move(F,c)}}),s?.forEachIdentityChange(d=>{let l=d.item;if(d.currentIndex!=null){let c=i.get(d.currentIndex);c.context.$implicit=l}}),o?this._changeDetectorRef.markForCheck():this._changeDetectorRef.detectChanges())}_getNodeDef(e,t){if(this._nodeDefs.length===1)return this._nodeDefs.first;let i=this._nodeDefs.find(o=>o.when&&o.when(t,e))||this._defaultNodeDef;return i}insertNode(e,t,i,o){let s=this._getLevelAccessor(),d=this._getNodeDef(e,t),l=this._getExpansionKey(e),c=new Oe(e);o??=this._parents.get(l)??void 0,s?c.level=s(e):o!==void 0&&this._levels.has(this._getExpansionKey(o))?c.level=this._levels.get(this._getExpansionKey(o))+1:c.level=0,this._levels.set(l,c.level),(i||this._nodeOutlet.viewContainer).createEmbeddedView(d.template,c,t),L.mostRecentTreeNode&&(L.mostRecentTreeNode.data=e)}isExpanded(e){return!!(this.treeControl?.isExpanded(e)||this._expansionModel?.isSelected(this._getExpansionKey(e)))}toggle(e){this.treeControl?this.treeControl.toggle(e):this._expansionModel&&this._expansionModel.toggle(this._getExpansionKey(e))}expand(e){this.treeControl?this.treeControl.expand(e):this._expansionModel&&this._expansionModel.select(this._getExpansionKey(e))}collapse(e){this.treeControl?this.treeControl.collapse(e):this._expansionModel&&this._expansionModel.deselect(this._getExpansionKey(e))}toggleDescendants(e){this.treeControl?this.treeControl.toggleDescendants(e):this._expansionModel&&(this.isExpanded(e)?this.collapseDescendants(e):this.expandDescendants(e))}expandDescendants(e){if(this.treeControl)this.treeControl.expandDescendants(e);else if(this._expansionModel){let t=this._expansionModel;t.select(this._getExpansionKey(e)),this._getDescendants(e).pipe(C(1),K(this._onDestroy)).subscribe(i=>{t.select(...i.map(o=>this._getExpansionKey(o)))})}}collapseDescendants(e){if(this.treeControl)this.treeControl.collapseDescendants(e);else if(this._expansionModel){let t=this._expansionModel;t.deselect(this._getExpansionKey(e)),this._getDescendants(e).pipe(C(1),K(this._onDestroy)).subscribe(i=>{t.deselect(...i.map(o=>this._getExpansionKey(o)))})}}expandAll(){this.treeControl?this.treeControl.expandAll():this._expansionModel&&this._forEachExpansionKey(e=>this._expansionModel?.select(...e))}collapseAll(){this.treeControl?this.treeControl.collapseAll():this._expansionModel&&this._forEachExpansionKey(e=>this._expansionModel?.deselect(...e))}_getLevelAccessor(){return this.treeControl?.getLevel?.bind(this.treeControl)??this.levelAccessor}_getChildrenAccessor(){return this.treeControl?.getChildren?.bind(this.treeControl)??this.childrenAccessor}_getDirectChildren(e){let t=this._getLevelAccessor(),i=this._expansionModel??this.treeControl?.expansionModel;if(!i)return h([]);let o=this._getExpansionKey(e),s=i.changed.pipe(W(l=>l.added.includes(o)?h(!0):l.removed.includes(o)?h(!1):Qe),we(this.isExpanded(e)));if(t)return q([s,this._flattenedNodes]).pipe(v(([l,c])=>l?this._findChildrenByLevel(t,c,e,1):[]));let d=this._getChildrenAccessor();if(d)return he(d(e)??[]);throw kt()}_findChildrenByLevel(e,t,i,o){let s=this._getExpansionKey(i),d=t.findIndex(z=>this._getExpansionKey(z)===s),l=e(i),c=l+o,F=[];for(let z=d+1;z<t.length;z++){let Ve=e(t[z]);if(Ve<=l)break;Ve<=c&&F.push(t[z])}return F}_registerNode(e){this._nodes.value.set(this._getExpansionKey(e.data),e),this._nodes.next(this._nodes.value)}_unregisterNode(e){this._nodes.value.delete(this._getExpansionKey(e.data)),this._nodes.next(this._nodes.value)}_getLevel(e){return this._levels.get(this._getExpansionKey(e))}_getSetSize(e){return this._getAriaSet(e).length}_getPositionInSet(e){let t=this._getAriaSet(e),i=this._getExpansionKey(e);return t.findIndex(o=>this._getExpansionKey(o)===i)+1}_getNodeParent(e){let t=this._parents.get(this._getExpansionKey(e.data));return t&&this._nodes.value.get(this._getExpansionKey(t))}_getNodeChildren(e){return this._getDirectChildren(e.data).pipe(v(t=>t.reduce((i,o)=>{let s=this._nodes.value.get(this._getExpansionKey(o));return s&&i.push(s),i},[])))}_sendKeydownToKeyManager(e){if(e.target===this._elementRef.nativeElement)this._keyManager.onKeydown(e);else{let t=this._nodes.getValue();for(let[,i]of t)if(e.target===i._elementRef.nativeElement){this._keyManager.onKeydown(e);break}}}_getDescendants(e){if(this.treeControl)return h(this.treeControl.getDescendants(e));if(this.levelAccessor){let t=this._findChildrenByLevel(this.levelAccessor,this._flattenedNodes.value,e,1/0);return h(t)}if(this.childrenAccessor)return this._getAllChildrenRecursively(e).pipe(Ie((t,i)=>(t.push(...i),t),[]));throw kt()}_getAllChildrenRecursively(e){return this.childrenAccessor?he(this.childrenAccessor(e)).pipe(C(1),W(t=>{for(let i of t)this._parents.set(this._getExpansionKey(i),e);return h(...t).pipe(Ne(i=>Ee(h([i]),this._getAllChildrenRecursively(i))))})):h([])}_getExpansionKey(e){return this.expansionKey?.(e)??e}_getAriaSet(e){let t=this._getExpansionKey(e),i=this._parents.get(t),o=i?this._getExpansionKey(i):null;return this._ariaSets.get(o)??[e]}_findParentForNode(e,t,i){if(!i.length)return null;let o=this._levels.get(this._getExpansionKey(e))??0;for(let s=t-1;s>=0;s--){let d=i[s];if((this._levels.get(this._getExpansionKey(d))??0)<o)return d}return null}_flattenNestedNodesWithExpansion(e,t=0){let i=this._getChildrenAccessor();return i?h(...e).pipe(Ne(o=>{let s=this._getExpansionKey(o);this._parents.has(s)||this._parents.set(s,null),this._levels.set(s,t);let d=he(i(o));return Ee(h([o]),d.pipe(C(1),X(l=>{this._ariaSets.set(s,[...l??[]]);for(let c of l??[]){let F=this._getExpansionKey(c);this._parents.set(F,o),this._levels.set(F,t+1)}}),W(l=>l?this._flattenNestedNodesWithExpansion(l,t+1).pipe(v(c=>this.isExpanded(o)?c:[])):h([]))))}),Ie((o,s)=>(o.push(...s),o),[])):h([...e])}_computeRenderingData(e,t){if(this.childrenAccessor&&t==="flat")return this._clearPreviousCache(),this._ariaSets.set(null,[...e]),this._flattenNestedNodesWithExpansion(e).pipe(v(i=>({renderNodes:i,flattenedNodes:i})));if(this.levelAccessor&&t==="nested"){let i=this.levelAccessor;return h(e.filter(o=>i(o)===0)).pipe(v(o=>({renderNodes:o,flattenedNodes:e})),X(({flattenedNodes:o})=>{this._calculateParents(o)}))}else return t==="flat"?h({renderNodes:e,flattenedNodes:e}).pipe(X(({flattenedNodes:i})=>{this._calculateParents(i)})):(this._clearPreviousCache(),this._ariaSets.set(null,[...e]),this._flattenNestedNodesWithExpansion(e).pipe(v(i=>({renderNodes:e,flattenedNodes:i}))))}_updateCachedData(e){this._flattenedNodes.next(e)}_updateKeyManagerItems(e){this._keyManagerNodes.next(e)}_calculateParents(e){let t=this._getLevelAccessor();if(t){this._clearPreviousCache();for(let i=0;i<e.length;i++){let o=e[i],s=this._getExpansionKey(o);this._levels.set(s,t(o));let d=this._findParentForNode(o,i,e);this._parents.set(s,d);let l=d?this._getExpansionKey(d):null,c=this._ariaSets.get(l)??[];c.splice(i,0,o),this._ariaSets.set(l,c)}}}_forEachExpansionKey(e){let t=[],i=[];this._nodes.value.forEach(o=>{t.push(this._getExpansionKey(o.data)),i.push(this._getDescendants(o.data))}),i.length>0?q(i).pipe(C(1),K(this._onDestroy)).subscribe(o=>{o.forEach(s=>s.forEach(d=>t.push(this._getExpansionKey(d)))),e(t)}):e(t)}_clearPreviousCache(){this._parents.clear(),this._levels.clear(),this._ariaSets.clear()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=x({type:n,selectors:[["cdk-tree"]],contentQueries:function(t,i,o){if(t&1&&tt(o,be,5),t&2){let s;N(s=w())&&(i._nodeDefs=s)}},viewQuery:function(t,i){if(t&1&&B(xe,7),t&2){let o;N(o=w())&&(i._nodeOutlet=o.first)}},hostAttrs:["role","tree",1,"cdk-tree"],hostBindings:function(t,i){t&1&&_("keydown",function(s){return i._sendKeydownToKeyManager(s)})},inputs:{dataSource:"dataSource",treeControl:"treeControl",levelAccessor:"levelAccessor",childrenAccessor:"childrenAccessor",trackBy:"trackBy",expansionKey:"expansionKey"},exportAs:["cdkTree"],decls:1,vars:0,consts:[["cdkTreeNodeOutlet",""]],template:function(t,i){t&1&&de(0,0)},dependencies:[xe],encapsulation:2})}return n})(),L=(()=>{class n{_elementRef=a(V);_tree=a(G);_tabindex=-1;_type="flat";get role(){return"treeitem"}set role(e){}get isExpandable(){return this._isExpandable()}set isExpandable(e){this._inputIsExpandable=e,!(this.data&&!this._isExpandable||!this._inputIsExpandable)&&(this._inputIsExpanded?this.expand():this._inputIsExpanded===!1&&this.collapse())}get isExpanded(){return this._tree.isExpanded(this._data)}set isExpanded(e){this._inputIsExpanded=e,e?this.expand():this.collapse()}isDisabled;typeaheadLabel;getLabel(){return this.typeaheadLabel||this._elementRef.nativeElement.textContent?.trim()||""}activation=new ee;expandedChange=new ee;static mostRecentTreeNode=null;_destroyed=new U;_dataChanges=new U;_inputIsExpandable=!1;_inputIsExpanded=void 0;_shouldFocus=!0;_parentNodeAriaLevel;get data(){return this._data}set data(e){e!==this._data&&(this._data=e,this._dataChanges.next())}_data;get isLeafNode(){return this._tree.treeControl?.isExpandable!==void 0&&!this._tree.treeControl.isExpandable(this._data)?!0:this._tree.treeControl?.isExpandable===void 0&&this._tree.treeControl?.getDescendants(this._data).length===0}get level(){return this._tree._getLevel(this._data)??this._parentNodeAriaLevel}_isExpandable(){return this._tree.treeControl?!this.isLeafNode:this._inputIsExpandable}_getAriaExpanded(){return this._isExpandable()?String(this.isExpanded):null}_getSetSize(){return this._tree._getSetSize(this._data)}_getPositionInSet(){return this._tree._getPositionInSet(this._data)}_changeDetectorRef=a(ne);constructor(){n.mostRecentTreeNode=this}ngOnInit(){this._parentNodeAriaLevel=Qt(this._elementRef.nativeElement),this._tree._getExpansionModel().changed.pipe(v(()=>this.isExpanded),Ge()).subscribe(()=>this._changeDetectorRef.markForCheck()),this._tree._setNodeTypeIfUnset(this._type),this._tree._registerNode(this)}ngOnDestroy(){n.mostRecentTreeNode===this&&(n.mostRecentTreeNode=null),this._dataChanges.complete(),this._destroyed.next(),this._destroyed.complete()}getParent(){return this._tree._getNodeParent(this)??null}getChildren(){return this._tree._getNodeChildren(this)}focus(){this._tabindex=0,this._shouldFocus&&this._elementRef.nativeElement.focus(),this._changeDetectorRef.markForCheck()}unfocus(){this._tabindex=-1,this._changeDetectorRef.markForCheck()}activate(){this.isDisabled||this.activation.next(this._data)}collapse(){this.isExpandable&&this._tree.collapse(this._data)}expand(){this.isExpandable&&this._tree.expand(this._data)}makeFocusable(){this._tabindex=0,this._changeDetectorRef.markForCheck()}_focusItem(){this.isDisabled||this._tree._keyManager.focusItem(this)}_setActiveItem(){this.isDisabled||(this._shouldFocus=!1,this._tree._keyManager.focusItem(this),this._shouldFocus=!0)}_emitExpansionState(e){this.expandedChange.emit(e)}static \u0275fac=function(t){return new(t||n)};static \u0275dir=m({type:n,selectors:[["cdk-tree-node"]],hostAttrs:["role","treeitem",1,"cdk-tree-node"],hostVars:5,hostBindings:function(t,i){t&1&&_("click",function(){return i._setActiveItem()})("focus",function(){return i._focusItem()}),t&2&&(le("tabindex",i._tabindex),A("aria-expanded",i._getAriaExpanded())("aria-level",i.level+1)("aria-posinset",i._getPositionInSet())("aria-setsize",i._getSetSize()))},inputs:{role:"role",isExpandable:[2,"isExpandable","isExpandable",M],isExpanded:"isExpanded",isDisabled:[2,"isDisabled","isDisabled",M],typeaheadLabel:[0,"cdkTreeNodeTypeaheadLabel","typeaheadLabel"]},outputs:{activation:"activation",expandedChange:"expandedChange"},exportAs:["cdkTreeNode"]})}return n})();function Qt(n){let r=n.parentElement;for(;r&&!$t(r);)r=r.parentElement;return r?r.classList.contains("cdk-nested-tree-node")?P(r.getAttribute("aria-level")):0:-1}function $t(n){let r=n.classList;return!!(r?.contains("cdk-nested-tree-node")||r?.contains("cdk-tree"))}var jt=/([A-Za-z%]+)$/,Le=(()=>{class n{_treeNode=a(L);_tree=a(G);_element=a(V);_dir=a(Se,{optional:!0});_currentPadding;_destroyed=new U;indentUnits="px";get level(){return this._level}set level(e){this._setLevelInput(e)}_level;get indent(){return this._indent}set indent(e){this._setIndentInput(e)}_indent=40;constructor(){this._setPadding(),this._dir?.change.pipe(K(this._destroyed)).subscribe(()=>this._setPadding(!0)),this._treeNode._dataChanges.subscribe(()=>this._setPadding())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_paddingIndent(){let e=(this._treeNode.data&&this._tree._getLevel(this._treeNode.data))??null,t=this._level==null?e:this._level;return typeof t=="number"?`${t*this._indent}${this.indentUnits}`:null}_setPadding(e=!1){let t=this._paddingIndent();if(t!==this._currentPadding||e){let i=this._element.nativeElement,o=this._dir&&this._dir.value==="rtl"?"paddingRight":"paddingLeft",s=o==="paddingLeft"?"paddingRight":"paddingLeft";i.style[o]=t||"",i.style[s]="",this._currentPadding=t}}_setLevelInput(e){this._level=isNaN(e)?null:e,this._setPadding()}_setIndentInput(e){let t=e,i="px";if(typeof e=="string"){let o=e.split(jt);t=o[0],i=o[1]||i}this.indentUnits=i,this._indent=P(t),this._setPadding()}static \u0275fac=function(t){return new(t||n)};static \u0275dir=m({type:n,selectors:[["","cdkTreeNodePadding",""]],inputs:{level:[2,"cdkTreeNodePadding","level",P],indent:[0,"cdkTreeNodePaddingIndent","indent"]}})}return n})(),ze=(()=>{class n{_tree=a(G);_treeNode=a(L);recursive=!1;constructor(){}_toggle(){this.recursive?this._tree.toggleDescendants(this._treeNode.data):this._tree.toggle(this._treeNode.data),this._tree._keyManager.focusItem(this._treeNode)}static \u0275fac=function(t){return new(t||n)};static \u0275dir=m({type:n,selectors:[["","cdkTreeNodeToggle",""]],hostAttrs:["tabindex","-1"],hostBindings:function(t,i){t&1&&_("click",function(s){return i._toggle(),s.stopPropagation()})("keydown.Enter",function(s){return i._toggle(),s.preventDefault()})("keydown.Space",function(s){return i._toggle(),s.preventDefault()})},inputs:{recursive:[2,"cdkTreeNodeToggleRecursive","recursive",M]}})}return n})();var Ft=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=J({type:n});static \u0275inj=Y({})}return n})();function Gt(n){return!!n._isNoopTreeKeyManager}var At=(()=>{class n extends L{get tabIndexInputBinding(){return this._tabIndexInputBinding}set tabIndexInputBinding(e){this._tabIndexInputBinding=e}_tabIndexInputBinding;defaultTabIndex=0;_getTabindexAttribute(){return Gt(this._tree._keyManager)?this.tabIndexInputBinding:this._tabindex}get disabled(){return this.isDisabled}set disabled(e){this.isDisabled=e}constructor(){super();let e=a(new ot("tabindex"),{optional:!0});this.tabIndexInputBinding=Number(e)||this.defaultTabIndex}ngOnInit(){super.ngOnInit()}ngOnDestroy(){super.ngOnDestroy()}static \u0275fac=function(t){return new(t||n)};static \u0275dir=m({type:n,selectors:[["mat-tree-node"]],hostAttrs:[1,"mat-tree-node"],hostVars:5,hostBindings:function(t,i){t&1&&_("click",function(){return i._focusItem()}),t&2&&(le("tabindex",i._getTabindexAttribute()),A("aria-expanded",i._getAriaExpanded())("aria-level",i.level+1)("aria-posinset",i._getPositionInSet())("aria-setsize",i._getSetSize()))},inputs:{tabIndexInputBinding:[2,"tabIndex","tabIndexInputBinding",e=>e==null?0:P(e)],disabled:[2,"disabled","disabled",M]},outputs:{activation:"activation",expandedChange:"expandedChange"},exportAs:["matTreeNode"],features:[R([{provide:L,useExisting:n}]),O]})}return n})(),Bt=(()=>{class n extends be{data;static \u0275fac=(()=>{let e;return function(i){return(e||(e=Z(n)))(i||n)}})();static \u0275dir=m({type:n,selectors:[["","matTreeNodeDef",""]],inputs:{when:[0,"matTreeNodeDefWhen","when"],data:[0,"matTreeNode","data"]},features:[R([{provide:be,useExisting:n}]),O]})}return n})();var Rt=(()=>{class n extends Le{get level(){return this._level}set level(e){this._setLevelInput(e)}get indent(){return this._indent}set indent(e){this._setIndentInput(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=Z(n)))(i||n)}})();static \u0275dir=m({type:n,selectors:[["","matTreeNodePadding",""]],inputs:{level:[2,"matTreeNodePadding","level",P],indent:[0,"matTreeNodePaddingIndent","indent"]},features:[R([{provide:Le,useExisting:n}]),O]})}return n})(),St=(()=>{class n{viewContainer=a(H);_node=a(Pe,{optional:!0});static \u0275fac=function(t){return new(t||n)};static \u0275dir=m({type:n,selectors:[["","matTreeNodeOutlet",""]],features:[R([{provide:xe,useExisting:n}])]})}return n})(),Ot=(()=>{class n extends G{_nodeOutlet=void 0;static \u0275fac=(()=>{let e;return function(i){return(e||(e=Z(n)))(i||n)}})();static \u0275cmp=x({type:n,selectors:[["mat-tree"]],viewQuery:function(t,i){if(t&1&&B(St,7),t&2){let o;N(o=w())&&(i._nodeOutlet=o.first)}},hostAttrs:[1,"mat-tree"],exportAs:["matTree"],features:[R([{provide:G,useExisting:n}]),O],decls:1,vars:0,consts:[["matTreeNodeOutlet",""]],template:function(t,i){t&1&&de(0,0)},dependencies:[St],styles:[`.mat-tree{display:block;background-color:var(--mat-tree-container-background-color, var(--mat-sys-surface))}.mat-tree-node,.mat-nested-tree-node{color:var(--mat-tree-node-text-color, var(--mat-sys-on-surface));font-family:var(--mat-tree-node-text-font, var(--mat-sys-body-large-font));font-size:var(--mat-tree-node-text-size, var(--mat-sys-body-large-size));font-weight:var(--mat-tree-node-text-weight, var(--mat-sys-body-large-weight))}.mat-tree-node{display:flex;align-items:center;flex:1;word-wrap:break-word;min-height:var(--mat-tree-node-min-height, 48px)}.mat-nested-tree-node{border-bottom-width:0}
`],encapsulation:2})}return n})(),Pt=(()=>{class n extends ze{static \u0275fac=(()=>{let e;return function(i){return(e||(e=Z(n)))(i||n)}})();static \u0275dir=m({type:n,selectors:[["","matTreeNodeToggle",""]],inputs:{recursive:[0,"matTreeNodeToggleRecursive","recursive"]},features:[R([{provide:ze,useExisting:n}]),O]})}return n})();var Lt=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=J({type:n});static \u0275inj=Y({imports:[Ft,Ae,Ae]})}return n})(),ye=class{transformFunction;getLevel;isExpandable;getChildren;constructor(r,e,t,i){this.transformFunction=r,this.getLevel=e,this.isExpandable=t,this.getChildren=i}_flattenNode(r,e,t,i){let o=this.transformFunction(r,e);if(t.push(o),this.isExpandable(o)){let s=this.getChildren(r);s&&(Array.isArray(s)?this._flattenChildren(s,e,t,i):s.pipe(C(1)).subscribe(d=>{this._flattenChildren(d,e,t,i)}))}return t}_flattenChildren(r,e,t,i){r.forEach((o,s)=>{let d=i.slice();d.push(s!=r.length-1),this._flattenNode(o,e+1,t,d)})}flattenNodes(r){let e=[];return r.forEach(t=>this._flattenNode(t,0,e,[])),e}expandFlattenedNodes(r,e){let t=[],i=[];return i[0]=!0,r.forEach(o=>{let s=!0;for(let d=0;d<=this.getLevel(o);d++)s=s&&i[d];s&&t.push(o),this.isExpandable(o)&&(i[this.getLevel(o)+1]=e.isExpanded(o))}),t}},Ce=class extends yt{_treeControl;_treeFlattener;_flattenedData=new y([]);_expandedData=new y([]);get data(){return this._data.value}set data(r){this._data.next(r),this._flattenedData.next(this._treeFlattener.flattenNodes(this.data)),this._treeControl.dataNodes=this._flattenedData.value}_data=new y([]);constructor(r,e,t){super(),this._treeControl=r,this._treeFlattener=e,t&&(this.data=t)}connect(r){return je(r.viewChange,this._treeControl.expansionModel.changed,this._flattenedData).pipe(v(()=>(this._expandedData.next(this._treeFlattener.expandFlattenedNodes(this._flattenedData.value,this._treeControl)),this._expandedData.value)))}disconnect(){}};var zt="mat-badge-content",qt=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=x({type:n,selectors:[["ng-component"]],decls:0,vars:0,template:function(t,i){},styles:[`.mat-badge{position:relative}.mat-badge.mat-badge{overflow:visible}.mat-badge-content{position:absolute;text-align:center;display:inline-block;transition:transform 200ms ease-in-out;transform:scale(0.6);overflow:hidden;white-space:nowrap;text-overflow:ellipsis;box-sizing:border-box;pointer-events:none;background-color:var(--mat-badge-background-color, var(--mat-sys-error));color:var(--mat-badge-text-color, var(--mat-sys-on-error));font-family:var(--mat-badge-text-font, var(--mat-sys-label-small-font));font-weight:var(--mat-badge-text-weight, var(--mat-sys-label-small-weight));border-radius:var(--mat-badge-container-shape, var(--mat-sys-corner-full))}.mat-badge-above .mat-badge-content{bottom:100%}.mat-badge-below .mat-badge-content{top:100%}.mat-badge-before .mat-badge-content{right:100%}[dir=rtl] .mat-badge-before .mat-badge-content{right:auto;left:100%}.mat-badge-after .mat-badge-content{left:100%}[dir=rtl] .mat-badge-after .mat-badge-content{left:auto;right:100%}@media(forced-colors: active){.mat-badge-content{outline:solid 1px;border-radius:0}}.mat-badge-disabled .mat-badge-content{background-color:var(--mat-badge-disabled-state-background-color, color-mix(in srgb, var(--mat-sys-error) 38%, transparent));color:var(--mat-badge-disabled-state-text-color, var(--mat-sys-on-error))}.mat-badge-hidden .mat-badge-content{display:none}.ng-animate-disabled .mat-badge-content,.mat-badge-content._mat-animation-noopable{transition:none}.mat-badge-content.mat-badge-active{transform:none}.mat-badge-small .mat-badge-content{width:var(--mat-badge-legacy-small-size-container-size, unset);height:var(--mat-badge-legacy-small-size-container-size, unset);min-width:var(--mat-badge-small-size-container-size, 6px);min-height:var(--mat-badge-small-size-container-size, 6px);line-height:var(--mat-badge-small-size-line-height, 6px);padding:var(--mat-badge-small-size-container-padding, 0);font-size:var(--mat-badge-small-size-text-size, 0);margin:var(--mat-badge-small-size-container-offset, -6px 0)}.mat-badge-small.mat-badge-overlap .mat-badge-content{margin:var(--mat-badge-small-size-container-overlap-offset, -6px)}.mat-badge-medium .mat-badge-content{width:var(--mat-badge-legacy-container-size, unset);height:var(--mat-badge-legacy-container-size, unset);min-width:var(--mat-badge-container-size, 16px);min-height:var(--mat-badge-container-size, 16px);line-height:var(--mat-badge-line-height, 16px);padding:var(--mat-badge-container-padding, 0 4px);font-size:var(--mat-badge-text-size, var(--mat-sys-label-small-size));margin:var(--mat-badge-container-offset, -12px 0)}.mat-badge-medium.mat-badge-overlap .mat-badge-content{margin:var(--mat-badge-container-overlap-offset, -12px)}.mat-badge-large .mat-badge-content{width:var(--mat-badge-legacy-large-size-container-size, unset);height:var(--mat-badge-legacy-large-size-container-size, unset);min-width:var(--mat-badge-large-size-container-size, 16px);min-height:var(--mat-badge-large-size-container-size, 16px);line-height:var(--mat-badge-large-size-line-height, 16px);padding:var(--mat-badge-large-size-container-padding, 0 4px);font-size:var(--mat-badge-large-size-text-size, var(--mat-sys-label-small-size));margin:var(--mat-badge-large-size-container-offset, -12px 0)}.mat-badge-large.mat-badge-overlap .mat-badge-content{margin:var(--mat-badge-large-size-container-overlap-offset, -12px)}
`],encapsulation:2,changeDetection:0})}return n})(),Kt=(()=>{class n{_ngZone=a(Ye);_elementRef=a(V);_ariaDescriber=a(_t);_renderer=a(Xe);_animationsDisabled=vt();_idGenerator=a(ft);get color(){return this._color}set color(e){this._setColor(e),this._color=e}_color="primary";overlap=!0;disabled;position="above after";get content(){return this._content}set content(e){this._updateRenderedContent(e)}_content;get description(){return this._description}set description(e){this._updateDescription(e)}_description;size="medium";hidden;_badgeElement;_inlineBadgeDescription;_isInitialized=!1;_interactivityChecker=a(gt);_document=a(We);constructor(){let e=a(ut);e.load(qt),e.load(ht)}isAbove(){return this.position.indexOf("below")===-1}isAfter(){return this.position.indexOf("before")===-1}getBadgeElement(){return this._badgeElement}ngOnInit(){this._clearExistingBadges(),this.content&&!this._badgeElement&&(this._badgeElement=this._createBadgeElement(),this._updateRenderedContent(this.content)),this._isInitialized=!0}ngOnDestroy(){this._renderer.destroyNode&&(this._renderer.destroyNode(this._badgeElement),this._inlineBadgeDescription?.remove()),this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this.description)}_isHostInteractive(){return this._interactivityChecker.isFocusable(this._elementRef.nativeElement,{ignoreVisibility:!0})}_createBadgeElement(){let e=this._renderer.createElement("span"),t="mat-badge-active";return e.setAttribute("id",this._idGenerator.getId("mat-badge-content-")),e.setAttribute("aria-hidden","true"),e.classList.add(zt),this._animationsDisabled&&e.classList.add("_mat-animation-noopable"),this._elementRef.nativeElement.appendChild(e),typeof requestAnimationFrame=="function"&&!this._animationsDisabled?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{e.classList.add(t)})}):e.classList.add(t),e}_updateRenderedContent(e){let t=`${e??""}`.trim();this._isInitialized&&t&&!this._badgeElement&&(this._badgeElement=this._createBadgeElement()),this._badgeElement&&(this._badgeElement.textContent=t),this._content=t}_updateDescription(e){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this.description),(!e||this._isHostInteractive())&&this._removeInlineDescription(),this._description=e,this._isHostInteractive()?this._ariaDescriber.describe(this._elementRef.nativeElement,e):this._updateInlineDescription()}_updateInlineDescription(){this._inlineBadgeDescription||(this._inlineBadgeDescription=this._document.createElement("span"),this._inlineBadgeDescription.classList.add("cdk-visually-hidden")),this._inlineBadgeDescription.textContent=this.description,this._badgeElement?.appendChild(this._inlineBadgeDescription)}_removeInlineDescription(){this._inlineBadgeDescription?.remove(),this._inlineBadgeDescription=void 0}_setColor(e){let t=this._elementRef.nativeElement.classList;t.remove(`mat-badge-${this._color}`),e&&t.add(`mat-badge-${e}`)}_clearExistingBadges(){let e=this._elementRef.nativeElement.querySelectorAll(`:scope > .${zt}`);for(let t of Array.from(e))t!==this._badgeElement&&t.remove()}static \u0275fac=function(t){return new(t||n)};static \u0275dir=m({type:n,selectors:[["","matBadge",""]],hostAttrs:[1,"mat-badge"],hostVars:20,hostBindings:function(t,i){t&2&&it("mat-badge-overlap",i.overlap)("mat-badge-above",i.isAbove())("mat-badge-below",!i.isAbove())("mat-badge-before",!i.isAfter())("mat-badge-after",i.isAfter())("mat-badge-small",i.size==="small")("mat-badge-medium",i.size==="medium")("mat-badge-large",i.size==="large")("mat-badge-hidden",i.hidden||!i.content)("mat-badge-disabled",i.disabled)},inputs:{color:[0,"matBadgeColor","color"],overlap:[2,"matBadgeOverlap","overlap",M],disabled:[2,"matBadgeDisabled","disabled",M],position:[0,"matBadgePosition","position"],content:[0,"matBadge","content"],description:[0,"matBadgeDescription","description"],size:[0,"matBadgeSize","size"],hidden:[2,"matBadgeHidden","hidden",M]}})}return n})();function Wt(n,r){if(n&1&&(p(0,"mat-icon",4),D(1),g()),n&2){let e=f();ce("color",e.node.iconColor),A("aria-label",e.node.type+"icon"),u(),$(" ",e.node.icon," ")}}function Xt(n,r){n&1&&I(0,"div")}function Yt(n,r){if(n&1&&(p(0,"span",2),S(1,Xt,1,0,"div",5),g()),n&2){let e=f(),t=Fe(2);b("matTooltip",e.node.warning),u(),b("ngTemplateOutlet",t)}}function Zt(n,r){n&1&&I(0,"div")}function Jt(n,r){if(n&1&&S(0,Zt,1,0,"div",5),n&2){f();let e=Fe(2);b("ngTemplateOutlet",e)}}var De=class n{node;static \u0275fac=function(e){return new(e||n)};static \u0275cmp=x({type:n,selectors:[["app-file-icon"]],inputs:{node:"node"},decls:7,vars:2,consts:[["fileIcon",""],[1,"vertical-center"],["matBadge","1","matBadgeSize","small",3,"matTooltip"],[1,"file-icon-title"],[1,"type-icon"],[4,"ngTemplateOutlet"]],template:function(e,t){e&1&&(p(0,"div",1),S(1,Wt,2,4,"ng-template",null,0,ue),te(3,Yt,2,2,"span",2)(4,Jt,1,1,"div"),p(5,"span",3),D(6),g()()),e&2&&(u(3),ie(t.node.warning!=null&&t.node.warning.length?3:4),u(3),pe(t.node.name))},dependencies:[Kt,fe,me,at],styles:[".type-icon[_ngcontent-%COMP%]{color:#757575}.vertical-center[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5em}.file-icon-title[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})};function Ke(n){return n.map(r=>oi(r))}function ei(n){switch(n.mimeType){case"application/vnd.google-apps.folder":return"folder";case"application/vnd.google-apps.spreadsheet":return"table_chart";case"application/pdf":return"picture_as_pdf";default:return"article"}}function ti(n){switch(n.mimeType){case"application/vnd.google-apps.spreadsheet":return"#1E8E3E";case"application/vnd.google-apps.document":return"#1A73E8";case"application/pdf":return"#F44336";default:return"grey"}}function ii(n){return n.mimeType?.includes("application/vnd.google-apps")?null:"Not a Google Document."}function ni(n){return n.mimeType==="application/vnd.google-apps.folder"?[]:void 0}function ri(n){return n.mimeType==="application/vnd.google-apps.folder"?"folder":"file"}function oi(n){return{id:n.id??"",name:n.name??"",type:ri(n),icon:ei(n),iconColor:ti(n),mimeType:n.mimeType??"",warning:ii(n),children:ni(n),file:n}}var si=["contextMenuTemplate"];function ai(n,r){if(n&1){let e=Q();p(0,"button",3),_("click",function(){let i=E(e).$implicit,o=f(2);return T(o.executeAction(i))}),D(1),g()}if(n&2){let e=r.$implicit;u(),$(" ",e.label," ")}}function di(n,r){if(n&1&&(p(0,"div",1),Je(1,ai,2,1,"button",2,Ze),g()),n&2){let e=f();u(),et(e.filteredMenuItems)}}var re=class n{contextMenuItems=[];contextMenuTemplate;onDocumentClick(r){r.type==="contextmenu"&&r.preventDefault(),this.close()}overlay=a(Dt);viewContainerRef=a(H);overlayRef=null;selectedContextMenuItem=null;filteredMenuItems=[];open(r,e){if(e.preventDefault(),e.stopPropagation(),this.close(),this.selectedContextMenuItem=r,this.filteredMenuItems=this.contextMenuItems.filter(o=>o.condition(r)),this.filteredMenuItems.length===0)return;let t=this.overlay.position().flexibleConnectedTo({x:e.clientX,y:e.clientY}).withPositions([{originX:"start",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"end",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"}]);this.overlayRef=this.overlay.create({positionStrategy:t,scrollStrategy:this.overlay.scrollStrategies.close(),hasBackdrop:!0,backdropClass:"cdk-overlay-transparent-backdrop"});let i=new bt(this.contextMenuTemplate,this.viewContainerRef);this.overlayRef.attach(i),this.overlayRef.backdropClick().subscribe(()=>this.close())}executeAction(r){this.selectedContextMenuItem&&r.action(this.selectedContextMenuItem),this.close()}close(){this.overlayRef&&(this.overlayRef.dispose(),this.overlayRef=null)}ngOnDestroy(){this.close()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=x({type:n,selectors:[["app-context-menu"]],viewQuery:function(e,t){if(e&1&&B(si,5,ae),e&2){let i;N(i=w())&&(t.contextMenuTemplate=i.first)}},hostBindings:function(e,t){e&1&&_("click",function(o){return t.onDocumentClick(o)},ke)("contextmenu",function(o){return t.onDocumentClick(o)},ke)},inputs:{contextMenuItems:"contextMenuItems"},decls:2,vars:0,consts:[["contextMenuTemplate",""],[1,"context-menu"],["mat-menu-item","",1,"context-menu-item"],["mat-menu-item","",1,"context-menu-item",3,"click"]],template:function(e,t){e&1&&S(0,di,3,0,"ng-template",null,0,ue)},dependencies:[lt,ge],styles:[".context-menu[_ngcontent-%COMP%]{background:#fff;border-radius:4px;box-shadow:0 2px 8px #00000026;padding:8px 0;min-width:160px}.context-menu-item[_ngcontent-%COMP%]{width:100%;text-align:left;border:none;background:none;padding:12px 16px;cursor:pointer;font-family:inherit;font-size:14px}.context-menu-item[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}"]})};var li=["driveTreeContextMenu"];function ci(n,r){if(n&1&&(p(0,"h2"),D(1),g()),n&2){let e=f();u(),pe(e.rootFolder.name)}}function pi(n,r){n&1&&(p(0,"h2"),D(1,"My Drive"),g())}function ui(n,r){n&1&&(p(0,"div",6),I(1,"mat-spinner"),g())}function hi(n,r){if(n&1){let e=Q();p(0,"mat-tree-node",10),_("click",function(){let i=E(e).$implicit,o=f(2);return T(o.selectFile(i))})("contextmenu",function(i){let o=E(e).$implicit,s=f(2);return T(s.openContextMenu(o,i))}),I(1,"app-file-icon",11),g()}if(n&2){let e=r.$implicit;u(),b("node",e)}}function gi(n,r){if(n&1){let e=Q();p(0,"mat-tree-node",12),_("click",function(){let i=E(e).$implicit,o=f(2);return T(o.selectFile(i))})("contextmenu",function(i){let o=E(e).$implicit,s=f(2);return T(s.openContextMenu(o,i))}),p(1,"button",13)(2,"mat-icon",14),_("click",function(){let i=E(e).$implicit,o=f(2);return T(o.toggleFolder(i))}),D(3),g()(),I(4,"app-file-icon",11),g()}if(n&2){let e=r.$implicit,t=f(2);u(),A("aria-label","Toggle "+e.name+"["+e.id+"]"),u(2),$(" ",t.treeControl.isExpanded(e)?"expand_more":"chevron_right"," "),u(),b("node",e)}}function fi(n,r){if(n&1&&(p(0,"mat-tree",7),S(1,hi,2,1,"mat-tree-node",8)(2,gi,5,3,"mat-tree-node",9),g()),n&2){let e=f();b("dataSource",e.dataSource)("treeControl",e.treeControl),u(2),b("matTreeNodeDefWhen",e.hasChild)}}var k=class{parentId="root";contextMenuItems=[];searchQuery={};height="calc(100vh - 64px)";select=new ee;driveTreeContextMenu;googleAuthService=a(Mt);googleDriveService=a(_e);cdr=a(ne);route=a(ct);isLoggedIn$;treeControl;treeFlattener;dataSource;contextMenuNode;rootFolder=null;loaded=!1;constructor(){this.treeFlattener=new ye(this.transformer,this.getLevel,this.isExpandable,this.getChildren),this.treeControl=new ve(this.getLevel,this.isExpandable),this.dataSource=new Ce(this.treeControl,this.treeFlattener),this.isLoggedIn$=this.googleAuthService.getIsLoggedIn()}ngOnInit(){this.parentId=this.route.snapshot.paramMap.get("parentId")||"root",this.isLoggedIn$.pipe(wt(this)).subscribe(r=>{r?(this.loadRootFiles(),this.googleDriveService.getFile(this.parentId).pipe(Te(e=>!!e)).subscribe(e=>{this.rootFolder=e})):(this.dataSource.data=[],this.loaded=!1)})}getLevel(r){return r.level}isExpandable(r){return r.expandable}hasChild(r,e){return e.expandable}getChildren(r){return r.children}refresh(){this.dataSource.data=[],this.loaded=!1,this.googleAuthService.getIsLoggedIn().pipe(C(1)).subscribe(r=>{r&&this.loadRootFiles()})}selectFile(r){switch(r.type){case"folder":this.selectFolder(r);break}this.select.emit(r)}toggleFolder(r){if(this.treeControl.isExpanded(r))return;let e=this.findNode(r.id,this.dataSource.data);e&&(e.children?.length||this.loadChildren(r,e))}openContextMenu(r,e){this.driveTreeContextMenu.open(r,e)}loadRootFiles(){this.googleDriveService.listFiles(this.searchBy(this.parentId??"root",this.searchQuery)).subscribe(r=>{this.dataSource.data=Ke(r),this.loaded=!0,this.cdr.markForCheck()})}getRootId(r){return r.filter(t=>t.parents?.length===1).reduce((t,i)=>(i.parents&&t.add(i.parents[0]),t),new Set).values().next().value||null}getRootFolder(r){let e=this.getRootId(r);return r.find(t=>t.id===e)||null}transformer(r,e){return{id:r.id,name:r.name,type:r.type,icon:r.icon,iconColor:r.iconColor,warning:r.warning,level:e,mimeType:r.mimeType,expandable:!!r.children,file:r.file}}selectFolder(r){if(this.treeControl.isExpanded(r)){this.treeControl.collapse(r);return}let e=this.findNode(r.id,this.dataSource.data);if(e){if(e.children?.length){this.expandTreeNode(r);return}this.loadChildren(r,e)}}loadChildren(r,e){!r||!e||r.id!==e.id||this.googleDriveService.listFiles(this.searchBy(r.id,this.searchQuery)).subscribe(t=>{let i=this.treeControl.dataNodes.filter(o=>this.treeControl.isExpanded(o));e.children=Ke(t),this.dataSource.data=[...this.dataSource.data],i.map(o=>this.treeControl.dataNodes.find(s=>s.id===o.id)).filter(o=>!!o).forEach(o=>{this.treeControl.expand(o)}),this.expandTreeNode(r)})}expandTreeNode(r){let e=this.treeControl.dataNodes.find(t=>t.id===r.id);e&&this.treeControl.expand(e)}collapseTreeNode(r){let e=this.treeControl.dataNodes.find(t=>t.id===r.id);e&&this.treeControl.collapse(e)}findNode(r,e){if(!e?.length)return null;let t=e.find(i=>i.id===r);return t||this.findNode(r,e.reduce((i,o)=>[...i,...o.children??[]],[]))}searchBy(r="root",e={}){return{q:this.googleDriveService.driveSearchQuery(se(oe({},e),{parentId:r}))}}};Me(k,"\u0275fac",function(e){return new(e||k)}),Me(k,"\u0275cmp",x({type:k,selectors:[["app-drive-tree"]],viewQuery:function(e,t){if(e&1&&B(li,5,re),e&2){let i;N(i=w())&&(t.driveTreeContextMenu=i.first)}},inputs:{parentId:"parentId",contextMenuItems:"contextMenuItems",searchQuery:"searchQuery",height:"height"},outputs:{select:"select"},decls:13,vars:8,consts:[["driveTreeContextMenu",""],[3,"contextMenuItems"],[1,"spacer"],["type","button","aria-label","Refresh","matIconButton","","matTooltip","Refresh",3,"click","disabled"],["aria-label","Refresh"],[1,"tree-container"],[1,"spinner-container"],[3,"dataSource","treeControl"],["matTreeNodeToggle","","matTreeNodePadding","",3,"click","contextmenu",4,"matTreeNodeDef"],["matTreeNodePadding","",3,"click","contextmenu",4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodeToggle","","matTreeNodePadding","",3,"click","contextmenu"],[3,"node"],["matTreeNodePadding","",3,"click","contextmenu"],["matIconButton","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror",3,"click"]],template:function(e,t){if(e&1){let i=Q();I(0,"app-context-menu",1,0),p(2,"mat-toolbar"),te(3,ci,2,1,"h2")(4,pi,2,0,"h2"),I(5,"span",2),p(6,"button",3),nt(7,"async"),_("click",function(){return E(i),T(t.refresh())}),p(8,"mat-icon",4),D(9,"refresh"),g()()(),p(10,"div",5),te(11,ui,2,0,"div",6)(12,fi,3,3,"mat-tree",7),g()}e&2&&(b("contextMenuItems",t.contextMenuItems),u(3),ie(t.rootFolder?3:4),u(3),b("disabled",!rt(7,6,t.isLoggedIn$)),u(4),ce("height",t.height),u(),ie(t.loaded?12:11))},dependencies:[Lt,Bt,Rt,Pt,Ot,At,ge,xt,Tt,fe,Et,dt,It,De,me,re],styles:[".tree-container[_ngcontent-%COMP%]{padding-left:8px;overflow-y:auto}app-file-icon[_ngcontent-%COMP%]{padding-left:8px}mat-toolbar[_ngcontent-%COMP%]{padding-left:8px;padding-right:8px}mat-tree-node[_ngcontent-%COMP%]{cursor:pointer}"]})),k=He([Nt()],k);var Ht=class n{_router=a(pt);_googleDriveService=a(_e);constructor(){}openFile(){return{label:"Open",condition:this.validFile(),action:this.openFileAction}}openFileAction=r=>{switch(r.mimeType){case"application/vnd.google-apps.document":this._router.navigate(["/dashboard/docs",r.id]).then(e=>{});break;case"application/vnd.google-apps.spreadsheet":this._router.navigate(["/dashboard/spreadsheets",r.id]).then(e=>{});break;case"application/pdf":this._router.navigate(["/dashboard/pdf",r.id]).then(e=>{});break}};validFile(){return r=>["application/vnd.google-apps.folder","application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.oasis.opendocument.text","application/pdf"].includes(r.mimeType)}openInGoogleDrive(){return{label:"Open in Google Drive",condition:this.validFile(),action:r=>{switch(r.mimeType){case"application/vnd.google-apps.document":window.open(`https://docs.google.com/document/d/${r.id}`,"_blank");break;case"application/vnd.google-apps.spreadsheet":window.open(`https://docs.google.com/spreadsheets/d/${r.id}`,"_blank");break;case"application/vnd.google-apps.folder":window.open(`https://drive.google.com/drive/folders/${r.id}`,"_blank");break;case"application/pdf":window.open(`https://drive.google.com/file/d/${r.id}`,"_blank");break;default:window.open(`https://drive.google.com/file/d/${r.id}`,"_blank")}}}}saveAsGoogleDoc(r=e=>{}){return{label:"Save as Google Doc",condition:e=>e.mimeType==="application/vnd.openxmlformats-officedocument.wordprocessingml.document",action:e=>{this._googleDriveService.saveAsGoogleDocAndOpenSpinnerDialog(e.id).subscribe(t=>r(t))}}}static \u0275fac=function(e){return new(e||n)};static \u0275prov=Ue({token:n,factory:n.\u0275fac,providedIn:"root"})};export{De as a,Ke as b,re as c,k as d,Ht as e};
