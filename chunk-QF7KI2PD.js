import{b as H,c as J}from"./chunk-Y2PEHK34.js";import{b as U}from"./chunk-VTHVZRSC.js";import"./chunk-XOLN6OYZ.js";import{a as G,c as N,d as q,e as z}from"./chunk-5C3QSQIV.js";import{a as R,c as F}from"./chunk-KSFLMSQQ.js";import{a as A}from"./chunk-USXQD7VS.js";import{g as V}from"./chunk-QA4PX2VU.js";import{ma as M,ta as O}from"./chunk-3QWJPETD.js";import{i as E}from"./chunk-WQZ5FTDX.js";import{Ac as s,F as I,Hb as f,Ib as y,Jb as h,Ob as w,Oc as D,Pb as n,Qb as a,Rb as g,Vb as B,Xb as L,Yb as _,_ as C,c as x,d as v,fb as l,hc as $,kc as u,l as b,la as c,lc as k,p as S,qa as T,qb as j,ra as P,zc as p}from"./chunk-GHECAUUU.js";function K(t,i){t&1&&(n(0,"h2"),u(1),a()),t&2&&(l(),k(i.content.name))}function Q(t,i){t&1&&g(0,"h2")}function W(t,i){t&1&&(n(0,"h2"),u(1,"Oh oh!"),a())}function X(t,i){t&1&&(n(0,"div",4),g(1,"mat-spinner"),a())}function Y(t,i){if(t&1){let e=B();n(0,"app-pdf-viewer",7,0),L("pdfLoaded",function(d){T(e);let m=_(2);return P(m.pdfLoaded(d))}),a()}if(t&2){let e=_(2);w("base64Src",i.pdf)("height",e.height)("width",e.width)("backgroundColor","var(--mat-sidenav-content-background-color, var(--mat-sys-background))")}}function Z(t,i){if(t&1&&(f(0,Y,2,4,"app-pdf-viewer",6),p(1,"async")),t&2){let e,o=_();h((e=s(1,1,o.doc$))?0:-1,e)}}function ee(t,i){t&1&&(n(0,"div",5),u(1,"Something went wrong loading the document."),a())}var r=class{height="100vh";width="812px";_googleAuthService=c(O);_googleDriveService=c(U);_route=c(V);_lastVisited=c(A);_cdr=c(D);_docSubject=new b(null);_docLoadStateSubject=new b("loading");isLoggedIn$;doc$=this._docSubject.asObservable();docLoadState$=this._docLoadStateSubject.asObservable();id=null;constructor(){this.isLoggedIn$=this._googleAuthService.getIsLoggedIn()}ngOnInit(){this.id=this._route.snapshot.paramMap.get("id"),this.id&&this._lastVisited.setLastPdfId(this.id)}ngAfterViewInit(){this.isLoggedIn$.pipe(z(this)).subscribe(i=>{i&&this.id?.length&&this.loadResource(this.id)})}loadResource(i=null){i?.length&&(this._docLoadStateSubject.next("loading"),this._googleDriveService.getPdfFromDrive(i).pipe(C(({file:e,blob:o})=>J(o).pipe(C(d=>S({pdf:d,content:e})))),I(e=>(console.error("Failed to get document",e),this._docLoadStateSubject.next("error"),S(null)))).subscribe(e=>{e&&(this._docSubject.next(e),this._docLoadStateSubject.next("loaded"),this._cdr.markForCheck())}))}refresh(){this.loadResource(this.id)}pdfLoaded(i){}};v(r,"\u0275fac",function(e){return new(e||r)}),v(r,"\u0275cmp",j({type:r,selectors:[["app-pdfs"]],inputs:{height:"height",width:"width"},decls:17,vars:14,consts:[["pdfViewer",""],[1,"spacer"],["type","button","aria-label","Refresh","matIconButton","","matTooltip","Refresh",3,"click","disabled"],["aria-label","Refresh"],[1,"spinner-container"],[1,"error"],[3,"base64Src","height","width","backgroundColor"],[3,"pdfLoaded","base64Src","height","width","backgroundColor"]],template:function(e,o){if(e&1&&(n(0,"div")(1,"mat-toolbar"),f(2,K,2,1,"h2"),p(3,"async"),y(4,Q,1,0,"h2"),f(5,W,2,0,"h2"),p(6,"async"),g(7,"span",1),n(8,"button",2),p(9,"async"),L("click",function(){return o.refresh()}),n(10,"mat-icon",3),u(11,"refresh"),a()()(),n(12,"div"),f(13,X,2,0,"div",4),p(14,"async"),y(15,Z,2,3)(16,ee,2,0,"div",5),a()()),e&2){let d,m;l(2),h((d=s(3,6,o.doc$))?2:4,d),l(3),h(s(6,8,o.docLoadState$)=="error"?5:-1),l(3),w("disabled",!s(9,10,o.isLoggedIn$)),l(4),$("height",o.height),l(),h((m=s(14,12,o.docLoadState$))==="loading"?13:m==="loaded"?15:m==="error"?16:-1)}},dependencies:[E,R,M,G,F,N,H],encapsulation:2})),r=x([q()],r);export{r as PdfComponent};
